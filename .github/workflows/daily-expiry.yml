name: Daily Membership Expiry Logic
on:
  schedule:
    # 18:30 UTC is exactly 00:00 IST (Indian Standard Time)
    - cron: '30 18 * * *'
  # This lets you test it manually by clicking a button in GitHub
  workflow_dispatch: 

jobs:
  ping-server:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Expiry Check API
        run: |
          curl --request POST \
          --url https://gymetric.onrender.com/api/system/run-expiry-check \
          --header 'Content-Type: application/json' \
          --data '{"secret": "${{ secrets.CRON_SECRET }}"}' \
          --fail \
          --retry 3